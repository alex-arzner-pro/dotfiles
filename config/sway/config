# ── Variables ──
set $mod Mod4
set $term kitty
set $menu fuzzel

# ── Input ──
input type:keyboard {
    xkb_layout de,ru
    xkb_options grp:caps_toggle
}

input type:touchpad {
    tap enabled
    natural_scroll enabled
    dwt enabled
}

# ── Appearance (Gruvbox Dark) ──
font pango:JetBrainsMono Nerd Font 10
default_border pixel 2
gaps inner 6
gaps outer 3
seat seat0 xcursor_theme Adwaita 24

# class                 border  bg      text    indicator child_border
client.focused          #d79921 #d79921 #282828 #fabd2f   #d79921
client.focused_inactive #504945 #504945 #ebdbb2 #504945   #504945
client.unfocused        #3c3836 #3c3836 #928374 #3c3836   #3c3836
client.urgent           #cc241d #cc241d #ebdbb2 #cc241d   #cc241d

# ── Status bar ──
bar {
    swaybar_command waybar
}

# ── Wallpaper ──
output * bg #282828 solid_color

# ── Monitors ──
include ~/.config/sway/config.d/*

# ── Keybindings: general ──
bindsym --to-code $mod+Return exec $term
bindsym --to-code $mod+d exec $menu
bindsym --to-code $mod+Shift+q kill
bindsym --to-code $mod+Shift+c reload
bindsym --to-code $mod+Shift+e exec swaynag -t warning -m 'Exit Sway?' -B 'Yes' 'swaymsg exit'

# ── Keybindings: focus ──
bindsym --to-code $mod+h focus left
bindsym --to-code $mod+j focus down
bindsym --to-code $mod+k focus up
bindsym --to-code $mod+l focus right
bindsym --to-code $mod+Left focus left
bindsym --to-code $mod+Down focus down
bindsym --to-code $mod+Up focus up
bindsym --to-code $mod+Right focus right

# ── Keybindings: move windows ──
bindsym --to-code $mod+Shift+h move left
bindsym --to-code $mod+Shift+j move down
bindsym --to-code $mod+Shift+k move up
bindsym --to-code $mod+Shift+l move right
bindsym --to-code $mod+Shift+Left move left
bindsym --to-code $mod+Shift+Down move down
bindsym --to-code $mod+Shift+Up move up
bindsym --to-code $mod+Shift+Right move right

# ── Keybindings: workspaces ──
bindsym --to-code $mod+1 workspace number 1
bindsym --to-code $mod+2 workspace number 2
bindsym --to-code $mod+3 workspace number 3
bindsym --to-code $mod+4 workspace number 4
bindsym --to-code $mod+5 workspace number 5
bindsym --to-code $mod+6 workspace number 6
bindsym --to-code $mod+7 workspace number 7
bindsym --to-code $mod+8 workspace number 8
bindsym --to-code $mod+9 workspace number 9

bindsym --to-code $mod+Shift+1 move container to workspace number 1
bindsym --to-code $mod+Shift+2 move container to workspace number 2
bindsym --to-code $mod+Shift+3 move container to workspace number 3
bindsym --to-code $mod+Shift+4 move container to workspace number 4
bindsym --to-code $mod+Shift+5 move container to workspace number 5
bindsym --to-code $mod+Shift+6 move container to workspace number 6
bindsym --to-code $mod+Shift+7 move container to workspace number 7
bindsym --to-code $mod+Shift+8 move container to workspace number 8
bindsym --to-code $mod+Shift+9 move container to workspace number 9

# ── Keybindings: layout ──
bindsym --to-code $mod+b splith
bindsym --to-code $mod+v splitv
bindsym --to-code $mod+f fullscreen toggle
bindsym --to-code $mod+s layout stacking
bindsym --to-code $mod+w layout tabbed
bindsym --to-code $mod+e layout toggle split
bindsym --to-code $mod+Shift+space floating toggle
bindsym --to-code $mod+space focus mode_toggle
floating_modifier $mod normal

# ── Resize mode ──
mode "resize" {
    bindsym --to-code h resize shrink width 30px
    bindsym --to-code j resize grow height 30px
    bindsym --to-code k resize shrink height 30px
    bindsym --to-code l resize grow width 30px
    bindsym --to-code Left resize shrink width 30px
    bindsym --to-code Down resize grow height 30px
    bindsym --to-code Up resize shrink height 30px
    bindsym --to-code Right resize grow width 30px
    bindsym --to-code Escape mode "default"
    bindsym --to-code Return mode "default"
}
bindsym --to-code $mod+r mode "resize"

# ── Screenshots ──
bindsym --to-code Print exec grim ~/Pictures/screenshot-$(date +%Y%m%d-%H%M%S).png
bindsym --to-code $mod+Print exec grim -g "$(slurp)" ~/Pictures/screenshot-$(date +%Y%m%d-%H%M%S).png
bindsym --to-code $mod+Shift+Print exec grim -g "$(slurp)" - | wl-copy

# ── Brightness ──
bindsym --to-code XF86MonBrightnessUp exec brightnessctl set +5%
bindsym --to-code XF86MonBrightnessDown exec brightnessctl set 5%-

# ── Audio ──
bindsym --to-code XF86AudioRaiseVolume exec pactl set-sink-volume @DEFAULT_SINK@ +5%
bindsym --to-code XF86AudioLowerVolume exec pactl set-sink-volume @DEFAULT_SINK@ -5%
bindsym --to-code XF86AudioMute exec pactl set-sink-mute @DEFAULT_SINK@ toggle
bindsym --to-code XF86AudioMicMute exec pactl set-source-mute @DEFAULT_SOURCE@ toggle

# ── Media ──
bindsym --to-code XF86AudioPlay exec playerctl play-pause
bindsym --to-code XF86AudioNext exec playerctl next
bindsym --to-code XF86AudioPrev exec playerctl previous

# ── Handy voice transcription ──
bindsym --to-code Ctrl+space exec handy --toggle-transcription

# ── Clipboard history ──
bindsym --to-code $mod+c exec cliphist list | fuzzel --dmenu | cliphist decode | wl-copy

# ── File manager ──
bindsym --to-code $mod+t exec thunar

# ── Lock screen ──
bindsym --to-code $mod+Escape exec swaylock -f

exec swayidle -w \
    timeout 300 'swaylock -f' \
    timeout 600 'swaymsg "output * power off"' \
    resume 'swaymsg "output * power on"' \
    before-sleep 'swaylock -f'

# ── Power menu ──
set $power "Power: (l)ock (e)xit (s)uspend (r)eboot (p)oweroff"
mode $power {
    bindsym --to-code l exec swaylock -f; mode "default"
    bindsym --to-code e exec swaymsg exit; mode "default"
    bindsym --to-code s exec systemctl suspend; mode "default"
    bindsym --to-code r exec systemctl reboot; mode "default"
    bindsym --to-code p exec systemctl poweroff; mode "default"
    bindsym --to-code Escape mode "default"
    bindsym --to-code Return mode "default"
}
bindsym --to-code $mod+Shift+p mode $power

# ── Autostart ──
exec eval $(gnome-keyring-daemon --start --components=secrets,pkcs11,ssh)
exec dbus-update-activation-environment --systemd WAYLAND_DISPLAY XDG_CURRENT_DESKTOP=sway
exec /usr/lib/policykit-1-gnome/polkit-gnome-authentication-agent-1
exec dunst
exec blueman-applet
exec nm-applet --indicator
exec udiskie --tray
exec wl-paste --watch cliphist store
exec_always kanshi
exec handy
exec_always gsettings set org.gnome.desktop.interface gtk-theme 'Adwaita-dark'
exec_always gsettings set org.gnome.desktop.interface color-scheme 'prefer-dark'
